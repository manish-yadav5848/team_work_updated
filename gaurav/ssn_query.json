{
    "query":[
        {
            "entity_name": "participant_core_balance_monthly",
            "query": "select retirement_account_id, collect_set(source_system)[0] as source_system, money_source, plan_number, participant_id, collect_set(money_source_name)[0] as money_source_name, collect_set(money_type_description)[0] as money_type_description, fund_number, collect_set(fund_name)[0] as fund_name, fund_iv, cast(sum(contribution_current_fis_year) as decimal) as contribution_current_fis_year, client_id, collect_set(action_code)[0] as action_code, collect_set(fund_margin_code)[0] as fund_margin_code, collect_set(account_fund_separate)[0] account_fund_separate, cast(sum(ytd_contributions)  as  decimal(17,2))  as  ytd_contributions, cast(sum(disbursements_withdrawal)  as  decimal(15,2))  as  disbursements_withdrawal, cast(max(vested_percent)  as  decimal(15,2))  as  vested_percent, cast(sum(vested_balance)  as  decimal(15,2))  as  vested_balance, cast(max(share_price)  as  decimal(19,6))  as  share_price, cast(sum(uninvested_balance)  as  decimal(15,2))  as  uninvested_balance, cast(sum(transfers_out)  as  decimal(15,2))  as  transfers_out, cast(sum(transfers_in)  as  decimal(15,2))  as  transfers_in, cast(sum(disbursements_termination)  as  decimal(15,2))  as  disbursements_termination, cast(sum(shares_sold)  as  decimal(13,4))  as  shares_sold, cast(sum(shares_receipted)  as  decimal(13,4))  as  shares_receipted, cast(sum(shares_purchased)  as  decimal(13,4))  as  shares_purchased, cast(sum(shares_forfeited)  as  decimal(15,2))  as  shares_forfeited, cast(sum(shares_distributed)  as  decimal(15,2))  as  shares_distributed, cast(sum(shares_debit_pending)  as  decimal(15,2))  as  shares_debit_pending, cast(sum(cash_debit_pending)  as  decimal(15,2))  as  cash_debit_pending, cast(sum(shares_credit_pending)  as  decimal(15,2))  as  shares_credit_pending, cast(sum(cash_credit_pending)  as  decimal(15,2))  as  cash_credit_pending, cast(sum(contrib_payment_attributable)  as  decimal(15,2))  as  contrib_payment_attributable, cast(sum(debits_other)  as  decimal(15,2))  as  debits_other, cast(sum(total_shares)  as  decimal(17,4))  as  total_shares, cast(sum(current_net_contribution)  as  decimal(15,2))  as  current_net_contribution, cast(sum(receipts_miscellanous)  as  decimal(15,2))  as  receipts_miscellanous, cast(sum(debits_miscellanous)  as  decimal(15,2))  as  debits_miscellanous, cast(sum(loan_repayment_principal)  as  decimal(15,2))  as  loan_repayment_principal, cast(sum(loan_repayment_interest)  as  decimal(15,2))  as  loan_repayment_interest, cast(sum(loan_issues)  as  decimal(15,2))  as  loan_issues, cast(sum(insurance_premium_paid)  as  decimal(15,2))  as  insurance_premium_paid, cast(sum(disbursements_installment)  as  decimal(15,2))  as  disbursements_installment, cast(sum(debited_forfeitures)  as  decimal(15,2))  as  debited_forfeitures, cast(sum(credited_forfeitures)  as  decimal(15,2))  as  credited_forfeitures, cast(sum(disbursements_fee)  as  decimal(15,2))  as  disbursements_fee, cast(sum(shares_gain_loss_earnings)  as  decimal(13,4))  as  shares_gain_loss_earnings, cast(sum(dividend_earnings)  as  decimal(15,2))  as  dividend_earnings, cast(sum(cash_earnings)  as  decimal(15,2))  as  cash_earnings, cast(sum(conversions_out)  as  decimal(15,2))  as  conversions_out, cast(sum(conversions_in)  as  decimal(15,2))  as  conversions_in, cast(sum(contribution_gross)  as  decimal(15,2))  as  contribution_gross, cast(max(contribution_alloc_pct)  as  decimal(13,4))  as  contribution_alloc_pct, cast(sum(cash_value_amount)  as  decimal(17,2))  as  cash_value_amount, cast(sum(sdba_cash_value_amount)  as  decimal(15,2))  as  sdba_cash_value_amount, cast(sum(annual_dividend_amount)  as  decimal(15,4))  as  annual_dividend_amount, cast(sum(accrued_dividend_amount)  as  decimal(15,4))  as  accrued_dividend_amount, cast(sum(net_dollars)  as  decimal(15,2))  as  net_dollars, cast(max(valuation_date) as date) as valuation_date, source_cycle_date, cast(max(sdba_trade_date) as date) as sdba_trade_date, cast(max(trade_date) as date) as trade_date from (select case when ssnh.new_participant_id is null then retirement_account_id else concat(plan_number,'-',ssnh.new_participant_id) end as retirement_account_id , ytd_contributions, disbursements_withdrawal, vested_percent, vested_balance, valuation_date, share_price, uninvested_balance, transfers_out, transfers_in, disbursements_termination, source_system, source_cycle_date, money_source, shares_sold, shares_receipted, shares_purchased, shares_forfeited, shares_distributed, plan_number, shares_debit_pending, cash_debit_pending, shares_credit_pending, cash_credit_pending, contrib_payment_attributable,coalesce(ssnh.new_participant_id,pcbm.participant_id) as participant_id, debits_other, total_shares, current_net_contribution, money_source_name, money_type_description, receipts_miscellanous, debits_miscellanous, loan_repayment_principal, loan_repayment_interest, loan_issues, insurance_premium_paid, disbursements_installment, fund_number, fund_name, fund_iv, debited_forfeitures, credited_forfeitures, disbursements_fee, shares_gain_loss_earnings, dividend_earnings, cash_earnings, conversions_out, conversions_in, contribution_gross, contribution_current_fis_year, contribution_alloc_pct, client_id, cash_value_amount, sdba_trade_date, sdba_cash_value_amount, annual_dividend_amount, action_code, accrued_dividend_amount, trade_date, net_dollars, fund_margin_code, account_fund_separate from participant_core_balance_monthly pcbm left outer  join (select old_participant_id,new_participant_id from  ssn_change_merge_helper where admin_tran_code in ('850','851')) ssnh on pcbm.participant_id=ssnh.old_participant_id) group by retirement_account_id, money_source, plan_number, participant_id, fund_number, fund_iv, client_id,source_cycle_date",
            "database": "newr_transform",
			"primary_keys":["plan_number","client_id","fund_iv","participant_id","money_source","retirement_account_id","fund_number","source_cycle_date"]
        },
        {
            "entity_name": "participant_balance_monthly",
            "query": "select  client_id , plan_number , participant_id  , source_cycle_date , cast(sum(core_cash_value_amount)  as  decimal(17,2)) as core_cash_value_amount, cast(sum(ee_cash_value_amount)  as  decimal(17,2)) as er_cash_value_amount, cast(sum(life_cash_value_amount_monthly)  as  decimal(13,2)) as life_cash_value_amount_monthly, max(life_valuation_date) life_valuation_date, cast(sum(sdba_cash_value_amount)  as  decimal(17,2)) as sdba_cash_value_amount, cast(sum(loan_cash_value_amount)  as  decimal(17,2)) as loan_cash_value_amount, cast(sum(noncore_cash_value_amount)  as  decimal(13,2)) as noncore_cash_value_amount, cast(sum(ytd_contributions)  as  decimal(17,2)) as ytd_contributions from (select client_id , plan_number ,case when ssn.new_participant_id is null then pbm.participant_id else ssn.new_participant_id end as participant_id , source_cycle_date , core_cash_value_amount  ,  ee_cash_value_amount , er_cash_value_amount  , life_cash_value_amount_monthly  , life_valuation_date , sdba_cash_value_amount   , loan_cash_value_amount  , noncore_cash_value_amount , ytd_contributions  from newr_consumption.participant_balance_monthly pbm left outer join  (select old_participant_id,new_participant_id from  newr_transform.ssn_change_merge_helper where admin_tran_code in ('850','851') and concat(tran_year,tran_month,tran_day)=(select max(concat(tran_year,tran_month,tran_day)) from newr_transform.ssn_change_merge_helper)) ssn on pbm.participant_id=ssn.new_participant_id) group by client_id , plan_number , participant_id  , source_cycle_date  ",
            "database": "newr_consumption",
			"primary_keys":["plan_number","client_id","participant_id","source_cycle_date"]
        },
		{
			"entity_name": "participant_balance_quarterly",
			"query": "select  client_id , plan_number , participant_id  , source_cycle_date , cast(sum(core_cash_value_amount)  as  decimal(17,2)) as core_cash_value_amount, cast(sum(ee_cash_value_amount)  as  decimal(17,2)) as er_cash_value_amount, cast(sum(life_cash_value_amount_monthly)  as  decimal(13,2)) as life_cash_value_amount_monthly, max(life_valuation_date) life_valuation_date, cast(sum(sdba_cash_value_amount)  as  decimal(17,2)) as sdba_cash_value_amount, cast(sum(loan_cash_value_amount)  as  decimal(17,2)) as loan_cash_value_amount, cast(sum(noncore_cash_value_amount)  as  decimal(13,2)) as noncore_cash_value_amount, cast(sum(ytd_contributions)  as  decimal(17,2)) as ytd_contributions from (select client_id , plan_number ,case when ssn.new_participant_id is null then pbm.participant_id else ssn.new_participant_id end as participant_id , source_cycle_date , core_cash_value_amount  ,  ee_cash_value_amount , er_cash_value_amount  , life_cash_value_amount_monthly  , life_valuation_date , sdba_cash_value_amount   , loan_cash_value_amount  , noncore_cash_value_amount , ytd_contributions  from newr_consumption.participant_balance_quarterly pbm left outer join  (select old_participant_id,new_participant_id from  newr_transform.ssn_change_merge_helper where admin_tran_code in ('850','851') and concat(tran_year,tran_month,tran_day)=(select max(concat(tran_year,tran_month,tran_day)) from newr_transform.ssn_change_merge_helper)) ssn on pbm.participant_id=ssn.new_participant_id) group by client_id , plan_number , participant_id  , source_cycle_date",
			"database": "newr_consumption",
			"primary_keys": ["plan_number","client_id","participant_id","source_cycle_date"]
		},
		{
			"entity_name": "part_fund_loan_monthly",
			"query": "select client_id, fund_number, participant_id, loan_number, plan_number, source_cycle_date,div_sub_id,cast(sum( LOAN_PRINCIPAL_REPAID) as decimal(11,2)) as LOAN_PRINCIPAL_REPAID, cast(sum( ORIGINAL_LOAN_AMOUNT)  as  decimal(11,2)) as ORIGINAL_LOAN_AMOUNT   , cast(sum( LOAN_CALENDAR_YEAR_INTEREST)  as  decimal(11,2)) as LOAN_CALENDAR_YEAR_INTEREST , cast(sum( LOAN_INTEREST_REPAID)  as  decimal(11,2)) as LOAN_INTEREST_REPAID   , cast(sum( loan_balance)  as  decimal(12,2)) as loan_balance   , max(LOAN_PAYMENT_PERCENT) as LOAN_PAYMENT_PERCENT  from (select pfl.client_id, fund_number, coalesce( ssnh.new_participant_id,participant_id) as participant_id, loan_number, pfl.plan_number, source_cycle_date, LOAN_PRINCIPAL_REPAID, ORIGINAL_LOAN_AMOUNT, LOAN_CALENDAR_YEAR_INTEREST, LOAN_INTEREST_REPAID, loan_balance, LOAN_PAYMENT_PERCENT, div_sub_id from newr_consumption.part_fund_loan_monthly pfl left outer join (select old_participant_id,new_participant_id from  newr_transform.ssn_change_merge_helper where admin_tran_code in ('850','851') and concat(tran_year,tran_month,tran_day)=(select max(concat(tran_year,tran_month,tran_day)) from newr_transform.ssn_change_merge_helper)) ssnh on pfl.participant_id=ssnh.old_participant_id )   group by client_id, fund_number, participant_id, loan_number, plan_number, source_cycle_date,div_sub_id",
			"database": "newr_consumption",
			"primary_keys": ["plan_number","participant_id","loan_number","fund_number","client_id","source_cycle_date"]
		},
		{
			"entity_name": "part_fund_loan_quarterly",
			"query": "select client_id, fund_number, participant_id, loan_number, plan_number, source_cycle_date,div_sub_id,cast(sum( LOAN_PRINCIPAL_REPAID) as decimal(11,2)) as LOAN_PRINCIPAL_REPAID, cast(sum( ORIGINAL_LOAN_AMOUNT)  as  decimal(11,2)) as ORIGINAL_LOAN_AMOUNT   , cast(sum( LOAN_CALENDAR_YEAR_INTEREST)  as  decimal(11,2)) as LOAN_CALENDAR_YEAR_INTEREST , cast(sum( LOAN_INTEREST_REPAID)  as  decimal(11,2)) as LOAN_INTEREST_REPAID   , cast(sum( loan_balance)  as  decimal(12,2)) as loan_balance   , max(LOAN_PAYMENT_PERCENT) as LOAN_PAYMENT_PERCENT  from (select pfl.client_id, fund_number, coalesce( ssnh.new_participant_id,participant_id) as participant_id, loan_number, pfl.plan_number, source_cycle_date, LOAN_PRINCIPAL_REPAID, ORIGINAL_LOAN_AMOUNT, LOAN_CALENDAR_YEAR_INTEREST, LOAN_INTEREST_REPAID, loan_balance, LOAN_PAYMENT_PERCENT, div_sub_id from newr_consumption.part_fund_loan_quarterly pfl left outer join (select old_participant_id,new_participant_id from  newr_transform.ssn_change_merge_helper where admin_tran_code in ('850','851') and concat(tran_year,tran_month,tran_day)=(select max(concat(tran_year,tran_month,tran_day)) from newr_transform.ssn_change_merge_helper)) ssnh on pfl.participant_id=ssnh.old_participant_id )   group by client_id, fund_number, participant_id, loan_number, plan_number, source_cycle_date,div_sub_id",
			"database": "newr_consumption",
			"primary_keys": ["plan_number","participant_id","loan_number","fund_number","client_id","source_cycle_date"]
		}
    ]
}