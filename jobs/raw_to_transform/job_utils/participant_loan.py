
from pyspark.sql import SparkSession
from pyspark.sql.functions import *

from wealthcentral.jobs.raw_to_transform.helper_utils.data_utils import merge_dataframes

def transform(spark: SparkSession, primary_key: list):

    nw00paap_nlarc_prdps_partloan_pdab_data_dat01_df = spark.sql("select  coalesce(q1.client_id,'-9999') as client_id, coalesce(loan_number, '-9999') as loan_number, coalesce(loan_type, '-9999') as loan_use_description, coalesce(participant_acc_num, '-9999') as participant_id,coalesce(participant_acc_num, '-9999') as retirement_account_id, coalesce(plan_id, '-9999') as plan_number ,CAST(null as INTEGER)  as to_loan_number, CAST(null as DATE)  as third_delinquency_notice_date, CAST(null as DATE)  as takeover_date, ss_loan_money_src_code, 'PREMIER' as source_system,cast(null as varchar(1)) as loan_use_indicator, CAST(cycle_date as DATE) as source_cycle_date, CAST(null as DATE)  as signed_date, CAST(null as DATE)  as second_delinquency_notice_date, CAST(null as INTEGER)  as residential_term, CAST(null as DECIMAL(9,2))  as process_fees, CAST(null as VARCHAR(12))  as prior_loan_number, CAST(null as VARCHAR(1))  as prior_frequency, CAST(null as DECIMAL(9,2))  as prepaid_fees, payment_frequency, CAST(null as DECIMAL(9,2))  as prior_year_highest_loan_balance,  part_aggr_src_system_name, CAST(null as DECIMAL(11,2))  as takeover_total_interest_paid, CAST(original_loan_amt as DECIMAL(17,2)) as original_loan_amount, CAST(null as DATE)  as next_periodic_interest_date, CAST(next_payment_date as DATE) as next_loan_payment_date, CAST(maturity_date as DATE),  CAST('-9999' as VARCHAR(10))  as loan_type_ind, CAST(null as DECIMAL(11,2))  as loan_total_expected_interest, CAST(null as VARCHAR(1))  as loan_status_flag, CAST(null as VARCHAR(20))  as loan_status_desc, CAST(loan_status_date as DATE) as loan_status_date, substring(trim(ss_loan_status_code),1,1) as loan_status_code, CAST(null as VARCHAR(1))  as loan_repayment_option, CAST(null as DATE)  as loan_refinance_date, CAST(null as DATE)  as loan_reamortization_date, CAST(null as VARCHAR(8))  as loan_payroll_code, CAST(null as DATE)  as loan_payoff_date, payment_frequency as loan_payment_frequency_desc, CAST(null as VARCHAR(1))  as loan_originator, CAST(null as VARCHAR(5))  as takeover_num_of_payments, CAST(loan_issue_date as DATE) as loan_issue_date, CAST(null as DECIMAL(7,6))  as loan_interest_rate, CAST(null as DATE)  as loan_inactive_date, CAST(null as VARCHAR(1))  as loan_exclusion_flag, CAST(null as INTEGER)  as loan_discharge_schedule_termn, CAST(null as VARCHAR(1))  as loan_amortization_type_flag, CAST(null as DATE)  as last_payment_date, CAST(null as INTEGER)  as from_loan_number, CAST(null as DATE)  as first_payment_date, CAST(null as DATE)  as first_delinquency_notice_date, CAST(null as DECIMAL(7,6))  as earnings_rate, CAST(null as VARCHAR(1))  as discharge_default_method, CAST(null as INTEGER) as discharge_deflt_freq_interval, CAST(null as DATE)  as delay_default_date, CAST(null as VARCHAR(1))  as default_terms, CAST(null as VARCHAR(1))  as default_notification_flag, CAST(null as DATE)  as deemed_offset_date, CAST(null as DECIMAL(7,6))  as deemed_interest_rate,  CAST(null as VARCHAR(1))  as compl_notify_ind, CAST(null as VARCHAR(1))  as compl_default_notify_flag, CAST(null as VARCHAR(1))  as arrears_method, CAST(null as VARCHAR(1))  as advance_payment_method, action_code, CAST(null as VARCHAR(20))  as ach_debit_flag_desc, cast(0.00 as DECIMAL(11,2)) as accumulated_inactive_interest,cast(0.00 as DECIMAL(11,2)) as annual_percentage_rate,cast(0.00 as DECIMAL(12,2)) as loan_balance,cast(0.00 as decimal(11,2)) as discharge_default_static_interest,cast(0.00 as DECIMAL(11,2)) as earnings_paid,cast(highest_outstndg_loan_bal as DECIMAL(17,2)) as highest_outstanding_loan_balance,cast(interest_paid_amt as DECIMAL(11,2)) as interest_paid_to_date,cast(null as VARCHAR(1)) as last_payment_calculation_ind,cast(0 as DECIMAL(12,2)) as last_payment_amount,cast(0.00 as DECIMAL(11,2)) as loan_fee_override_amt,cast(0.00 as decimal(11,2)) as loan_interest_applied_to_princ,cast(0.00 as DECIMAL(11,2)) as loan_interest_in_arrears,coalesce(cast(payment_amount as DECIMAL(17,2)), 0) AS loan_payment_amount,cast(0.00 as DECIMAL(11,2)) as loan_principal_in_arrears,cast(null as INTEGER) as number_of_payments_in_arrears,cast(0 as DECIMAL(12,2)) as takeover_amount,cast(outstanding_interest_bal_amt as Decimal(17,2)) as outstanding_interest_balance,cast(outstanding_prncpl_bal_amt as decimal(17,2)) as outstanding_principal_balance,cast(null as INTEGER) as payment_default_loan,cast(princpal_paid_amt as DECIMAL(17,2)) as principal_paid_to_date_amt,CAST(null as VARCHAR(1))  as ach_debit_flag from `nw00paap_nlarc_prdps_partloan_pdab_data` m1 left outer join `nw00paap_nlarc_prdps_plan_pdab_data` q1 on m1.plan_id=q1.plan_number")

    exn_xxewre01_xxewrppl_jb_df = spark.sql("select  coalesce(client_id, '-9999') as client_id,coalesce(loan_number, '-9999') as loan_number,concat(plan_number,'~',participant_id) as retirement_account_id, case when loan_use_indicator='0' then 'G' when trim(loan_use_indicator) = '' then 'G' when loan_use_indicator='1' then 'R' else loan_type_id end as loan_use_description,coalesce(participant_id, '-9999') as participant_id,coalesce(plan_number, '-9999') as plan_number,CAST(to_loan_number as INTEGER), CAST(third_delinquent_notice_date as DATE) as third_delinquency_notice_date, CAST(takeover_date as DATE), CAST(null as VARCHAR(10))  as ss_loan_money_src_code,loan_use_indicator,'VRP-SP' as source_system, CAST(source_cycle_date as DATE), CAST(signed_date as DATE), CAST(second_delinquency_notice_date as DATE), CAST(residential_term as INTEGER), CAST(process_fees as DECIMAL(9,2)), prior_loan_number, prior_frequency, CAST(prepaid_fees as DECIMAL(9,2)), CAST(past_year_highest_loan_balance as DECIMAL(9,2)) as prior_year_highest_loan_balance,  CAST(null as VARCHAR(80))  as part_aggr_src_system_name, CAST(original_total_interest_paid as DECIMAL(11,2)) as takeover_total_interest_paid, CAST(original_loan_amount as DECIMAL(17,2)), CAST(next_periodic_interest_date as DATE), CAST(date_of_next_loan_payment as DATE) as next_loan_payment_date, CAST(loan_payoff_date as DATE)  as maturity_date, coalesce(loan_type_flag, '-9999') as loan_type_ind, CAST(loan_total_expected_interest as DECIMAL(11,2)),  loan_status_flag,CASE when LOAN_STATUS_FLAG= '0' then 'ACTIVE' when LOAN_STATUS_FLAG= ''  then 'ACTIVE' when LOAN_STATUS_FLAG is null then 'ACTIVE' when LOAN_STATUS_FLAG='1' then 'NORMAL PAYOFF' when LOAN_STATUS_FLAG='2' then 'DISCHARGED'when LOAN_STATUS_FLAG='3' then 'DEFAULTED' when LOAN_STATUS_FLAG='4' then 'REFINANCED' when LOAN_STATUS_FLAG='5' then 'TRANSFERRED' when LOAN_STATUS_FLAG='6' then 'REVERSED' when LOAN_STATUS_FLAG='7' then 'PENDING-FORECLOUSER' when LOAN_STATUS_FLAG='8' then 'DEEMED-DISTRIBUITED' when LOAN_STATUS_FLAG='A' then 'ACTIVE-DMD' when LOAN_STATUS_FLAG='B' then 'REPAID-DMD'when LOAN_STATUS_FLAG='C' then 'OFFSET-DMD' when (loan_status_flag ='1'or loan_status_flag='2'or loan_status_flag='4'or loan_status_flag='5' or loan_status_flag='6'or loan_status_flag='7') and (date_of_previous_loan_payment > Current_date() -1 ) then 'NORMAL PAYOFF' END AS loan_status_desc, CAST(null as DATE)  as loan_status_date, trim(loan_status_code) as loan_status_code, loan_repayment_option, CAST(loan_refinance_date as DATE), CAST(loan_reamortization_date as DATE), loan_payroll_code, CAST(loan_payoff_date as DATE),CASE when loan_payment_frequency='3' then 'Quarterly' when loan_payment_frequency='4' then 'Monthly' when loan_payment_frequency='5' then 'Semi-Monthly' when loan_payment_frequency='6' then 'Biwkly' when loan_payment_frequency='7' then 'Weekly' when loan_payment_frequency='8' then 'Daily' when loan_payment_frequency='A' then 'Weekly Plus' when loan_payment_frequency='B' then '48 Week' when loan_payment_frequency='9' then 'Biwkly Plus' END AS loan_payment_frequency_desc, loan_originator, loan_original_number_of_payments as takeover_num_of_payments, CAST(date_of_loan_issuance as DATE) as loan_issue_date, CAST(loan_interest_rate as DECIMAL(7,6)), CAST(loan_inactive_date as DATE), loan_exclusion_flag, CAST(loan_discharge_schedule_at_termination as INTEGER) as loan_discharge_schedule_termn, loan_amortization_type_flag, CAST(last_repayment_date as DATE) as last_payment_date, CAST(from_loan_number as INTEGER), CAST(first_payment_date as DATE)  as first_payment_date, CAST(first_delinquency_notice_date as DATE), CAST(earnings_rate as DECIMAL(7,6)), discharge_default_method, CAST(discharge_default_frequency_interval as INTEGER) as discharge_deflt_freq_interval, CAST(delay_default_date as DATE), default_terms, default_notification_flag, CAST(deemed_offset_date as DATE), CAST(deemed_interest_rate as DECIMAL(7,6)), compliance_notification_flag as compl_notify_ind, compliance_default_notification_flag as compl_default_notify_flag, arrears_method, advance_payment_method, CAST(null as VARCHAR(1))  as action_code, ach_debit_flag_desc, ach_debit_flag, loan_payment_frequency as payment_frequency,cast ( accumulated_inactive_interest as DECIMAL(11,2) ) as accumulated_inactive_interest,cast ( annual_percentage_rate as DECIMAL(11,2) ) as annual_percentage_rate,case when loan_status_flag in ('1','5','C') then  cast('0' as DECIMAL(12,2)) when loan_status_flag in ('2','4','6','7') and date_diff(coalesce(source_cycle_date,current_date-1),date_of_previous_loan_payment)>365 then  cast('0' as DECIMAL(12,2))  else coalesce(cast(current_loan_balance as DECIMAL(12,2)), 0) end  as loan_balance,cast ( discharge_default_static_interest as DECIMAL(11,2) ) as discharge_default_static_interest,cast ( earnings_interest_paid as DECIMAL(11,2) ) as earnings_paid,cast (Null  as DECIMAL(17,2)) as highest_outstanding_loan_balance,cast(loan_total_interest_paid as DECIMAL(11,2)) as interest_paid_to_date,last_payment_calculation as last_payment_calculation_ind,coalesce(cast( last_repayment_amount as DECIMAL(12,2)), 0) as last_payment_amount,cast ( loan_fee_override_amt as DECIMAL(11,2) ) as loan_fee_override_amt,cast ( loan_interest_applied_to_principal as DECIMAL(11,2) ) as loan_interest_applied_to_princ,cast ( loan_interest_in_arrears as DECIMAL(11,2) ) as loan_interest_in_arrears,coalesce(cast(loan_payment_amount as DECIMAL(17,2)), 0) as loan_payment_amount,cast (loan_principal_in_arrears as DECIMAL(11,2)) as loan_principal_in_arrears,cast(number_of_payments_in_arrears as INTEGER),coalesce(cast(original_takeover_amount as DECIMAL(12,2)), 0) as takeover_amount,cast(0 as DECIMAL(17,2)) as outstanding_interest_balance,cast(0 as DECIMAL(17, 2)) as outstanding_principal_balance,cast(payment_default_loan as INTEGER),cast(0 as DECIMAL(17,2)) as principal_paid_to_date_amt from exn_xxewre01_xxewrppl_jb ;")

    exn_xxewre01_xxewrppl_ng_df = spark.sql("select  coalesce(client_id, '-9999') as client_id,coalesce(loan_number, '-9999') as loan_number,concat(plan_number,'~',participant_id) as retirement_account_id, case when loan_use_indicator='0' then 'G' when trim(loan_use_indicator) = '' then 'G' when loan_use_indicator='1' then 'R' else loan_type_id end as loan_use_description,coalesce(participant_id, '-9999') as participant_id,coalesce(plan_number, '-9999') as plan_number,CAST(to_loan_number as INTEGER), CAST(third_delinquent_notice_date as DATE) as third_delinquency_notice_date, CAST(takeover_date as DATE), CAST(null as VARCHAR(10))  as ss_loan_money_src_code,loan_use_indicator,'VRP-PB' as source_system, CAST(source_cycle_date as DATE), CAST(signed_date as DATE), CAST(second_delinquency_notice_date as DATE), CAST(residential_term as INTEGER), CAST(process_fees as DECIMAL(9,2)), prior_loan_number, prior_frequency, CAST(prepaid_fees as DECIMAL(9,2)), CAST(past_year_highest_loan_balance as DECIMAL(9,2)) as prior_year_highest_loan_balance, CAST(null as VARCHAR(80))  as part_aggr_src_system_name, CAST(original_total_interest_paid as DECIMAL(11,2)) as takeover_total_interest_paid, CAST(original_loan_amount as DECIMAL(17,2)), CAST(next_periodic_interest_date as DATE), CAST(date_of_next_loan_payment as DATE) as next_loan_payment_date, CAST(loan_payoff_date as DATE)  as maturity_date, coalesce(loan_type_flag, '-9999') as loan_type_ind, CAST(loan_total_expected_interest as DECIMAL(11,2)),  loan_status_flag,CASE when LOAN_STATUS_FLAG= '0' then 'ACTIVE' when LOAN_STATUS_FLAG= ''  then 'ACTIVE' when LOAN_STATUS_FLAG is null then 'ACTIVE' when LOAN_STATUS_FLAG='1' then 'NORMAL PAYOFF' when LOAN_STATUS_FLAG='2' then 'DISCHARGED'when LOAN_STATUS_FLAG='3' then 'DEFAULTED' when LOAN_STATUS_FLAG='4' then 'REFINANCED' when LOAN_STATUS_FLAG='5' then 'TRANSFERRED' when LOAN_STATUS_FLAG='6' then 'REVERSED' when LOAN_STATUS_FLAG='7' then 'PENDING-FORECLOUSER' when LOAN_STATUS_FLAG='8' then 'DEEMED-DISTRIBUITED' when LOAN_STATUS_FLAG='A' then 'ACTIVE-DMD' when LOAN_STATUS_FLAG='B' then 'REPAID-DMD'when LOAN_STATUS_FLAG='C' then 'OFFSET-DMD' when (loan_status_flag ='1'or loan_status_flag='2'or loan_status_flag='4'or loan_status_flag='5' or loan_status_flag='6'or loan_status_flag='7') and (date_of_previous_loan_payment > Current_date() -1 ) then 'NORMAL PAYOFF' END AS loan_status_desc, CAST(null as DATE)  as loan_status_date, trim(loan_status_code) as loan_status_code, loan_repayment_option, CAST(loan_refinance_date as DATE), CAST(loan_reamortization_date as DATE), loan_payroll_code, CAST(loan_payoff_date as DATE),CASE when loan_payment_frequency='3' then 'Quarterly' when loan_payment_frequency='4' then 'Monthly' when loan_payment_frequency='5' then 'Semi-Monthly' when loan_payment_frequency='6' then 'Biwkly' when loan_payment_frequency='7' then 'Weekly' when loan_payment_frequency='8' then 'Daily' when loan_payment_frequency='A' then 'Weekly Plus' when loan_payment_frequency='B' then '48 Week' when loan_payment_frequency='9' then 'Biwkly Plus' END AS loan_payment_frequency_desc, loan_originator, loan_original_number_of_payments as takeover_num_of_payments, CAST(date_of_loan_issuance as DATE) as loan_issue_date, CAST(loan_interest_rate as DECIMAL(7,6)), CAST(loan_inactive_date as DATE), loan_exclusion_flag, CAST(loan_discharge_schedule_at_termination as INTEGER) as loan_discharge_schedule_termn, loan_amortization_type_flag, CAST(last_repayment_date as DATE) as last_payment_date, CAST(from_loan_number as INTEGER), CAST(NULL as DATE)  as first_payment_date, CAST(first_delinquency_notice_date as DATE), CAST(earnings_rate as DECIMAL(7,6)), discharge_default_method, CAST(discharge_default_frequency_interval as INTEGER) as discharge_deflt_freq_interval, CAST(delay_default_date as DATE), default_terms, default_notification_flag, CAST(deemed_offset_date as DATE), CAST(deemed_interest_rate as DECIMAL(7,6)), compliance_notification_flag as compl_notify_ind, compliance_default_notification_flag as compl_default_notify_flag, arrears_method, advance_payment_method, CAST(null as VARCHAR(1))  as action_code, ach_debit_flag_desc, ach_debit_flag, loan_payment_frequency as payment_frequency,cast ( accumulated_inactive_interest as DECIMAL(11,2) ) as accumulated_inactive_interest,cast ( annual_percentage_rate as DECIMAL(11,2) ) as annual_percentage_rate,case when loan_status_flag in ('1','5','C') then  cast('0' as DECIMAL(12,2)) when loan_status_flag in ('2','4','6','7') and date_diff(coalesce(source_cycle_date,current_date-1),date_of_previous_loan_payment)>365 then  cast('0' as DECIMAL(12,2))  else coalesce(cast(current_loan_balance as DECIMAL(12,2)), 0) end   as loan_balance,cast ( discharge_default_static_interest as DECIMAL(11,2) ) as discharge_default_static_interest,cast ( earnings_interest_paid as DECIMAL(11,2) ) as earnings_paid,cast (Null as DECIMAL(17,2)) as highest_outstanding_loan_balance,cast(loan_total_interest_paid as DECIMAL(11,2)) as interest_paid_to_date,last_payment_calculation as last_payment_calculation_ind,coalesce(cast( last_repayment_amount as DECIMAL(12,2)), 0) as last_payment_amount,cast ( loan_fee_override_amt as DECIMAL(11,2) ) as loan_fee_override_amt,cast ( loan_interest_applied_to_principal as DECIMAL(11,2) ) as loan_interest_applied_to_princ,cast ( loan_interest_in_arrears as DECIMAL(11,2) ) as loan_interest_in_arrears,coalesce(cast(loan_payment_amount as DECIMAL(17,2)), 0) as loan_payment_amount,cast (loan_principal_in_arrears as DECIMAL(11,2)) as loan_principal_in_arrears,cast(number_of_payments_in_arrears as INTEGER),coalesce(cast(original_takeover_amount as DECIMAL(12,2)), 0) as takeover_amount,cast(0 as DECIMAL(17,2)) as outstanding_interest_balance,cast(0 as DECIMAL(17, 2)) as outstanding_principal_balance,cast(payment_default_loan as INTEGER),cast(0 as DECIMAL(17,2)) as principal_paid_to_date_amt from exn_xxewre01_xxewrppl_ng ;")

    super_omni_newr_loanval_daily_ng_dat_df = spark.sql("select  coalesce(client_id, '-9999') as client_id, coalesce(loan_number,'-9999') as loan_number,concat(plan_number,'~',participant_id) as retirement_account_id, loan_use_indicator  as loan_use_description,coalesce(participant_id, '-9999') as participant_id,  coalesce(plan_number, '-9999') as plan_number,CAST(null as INTEGER)  as to_loan_number, CAST(null as DATE)  as third_delinquency_notice_date, CAST(null as DATE)  as takeover_date, CAST(null as VARCHAR(10))  as ss_loan_money_src_code,cast(null as varchar(1)) as loan_use_indicator, 'VRP-PB' as source_system, CAST(source_cycle_date as DATE), CAST(null as DATE)  as signed_date, CAST(null as DATE)  as second_delinquency_notice_date, CAST(null as INTEGER)  as residential_term, CAST(null as DECIMAL(9,2))  as process_fees, CAST(null as VARCHAR(12))  as prior_loan_number, CAST(null as VARCHAR(1))  as prior_frequency, CAST(null as DECIMAL(9,2))  as prepaid_fees, CAST(null as DECIMAL(9,2))  as prior_year_highest_loan_balance, CAST(null as VARCHAR(80))  as part_aggr_src_system_name, CAST(null as DECIMAL(11,2))  as takeover_total_interest_paid, CAST(null as DECIMAL(17,2))  as original_loan_amount, CAST(null as DATE)  as next_periodic_interest_date, CAST(null as DATE)  as next_loan_payment_date, CAST(null as DATE)  as maturity_date,  CAST('-9999' as VARCHAR(10))  as loan_type_ind, CAST(null as DECIMAL(11,2))  as loan_total_expected_interest,  CAST(null as VARCHAR(1)) as loan_status_flag, loan_status_desc, CAST(loan_status_date as DATE) as loan_status_date, CAST(null as VARCHAR(254))  as loan_status_code, CAST(null as VARCHAR(1))  as loan_repayment_option, CAST(null as DATE)  as loan_refinance_date, CAST(null as DATE)  as loan_reamortization_date, CAST(null as VARCHAR(8)) as loan_payroll_code, CAST(null as DATE)  as loan_payoff_date, case when loan_payment_frequency_long_desc = 'Fortnightly' then 'Biwkly' when loan_payment_frequency_long_desc='Fortnightly Plus' then 'Biwkly Plus' else loan_payment_frequency_long_desc end as loan_payment_frequency_desc,  CAST(null as VARCHAR(1))  as loan_originator, CAST(null as VARCHAR(5))  as takeover_num_of_payments, CAST(null as DATE)  as loan_issue_date, CAST(null as DECIMAL(7,6))  as loan_interest_rate, CAST(null as DATE)  as loan_inactive_date, CAST(null as VARCHAR(1))  as loan_exclusion_flag, CAST(null as INTEGER)  as loan_discharge_schedule_termn, CAST(null as VARCHAR(1))  as loan_amortization_type_flag, CAST(null as DATE)  as last_payment_date, CAST(null as INTEGER)  as from_loan_number, CAST(first_payment_date as DATE) as first_payment_date, CAST(null as DATE)  as first_delinquency_notice_date, CAST(null as DECIMAL(7,6))  as earnings_rate, CAST(null as VARCHAR(1))  as discharge_default_method, CAST(null as INTEGER)  as discharge_deflt_freq_interval, CAST(null as DATE)  as delay_default_date, CAST(null as VARCHAR(1))  as default_terms, CAST(null as VARCHAR(1))  as default_notification_flag, CAST(null as DATE)  as deemed_offset_date, CAST(null as DECIMAL(7,6))  as deemed_interest_rate, CAST(null as VARCHAR(1))  as compl_notify_ind, CAST(null as VARCHAR(1))  as compl_default_notify_flag, CAST(null as VARCHAR(1))  as arrears_method, CAST(null as VARCHAR(1))  as advance_payment_method, CAST(null as VARCHAR(1))  as action_code, cast(null as VARCHAR(1)) as payment_frequency, CAST(null as VARCHAR(20))  as ach_debit_flag_desc, CAST(null as VARCHAR(1))  as ach_debit_flag,cast(0.00 as DECIMAL(11,2)) as accumulated_inactive_interest,cast(0.00 as DECIMAL(11,2)) as annual_percentage_rate,cast(0 as DECIMAL(12,2)) as loan_balance,cast(0.00 as decimal(11,2)) as discharge_default_static_interest,cast ( interest_paid as DECIMAL(11,2) ) as earnings_paid,cast (highest_outstanding_loan_balance as DECIMAL(17,2)) as highest_outstanding_loan_balance,cast(interest_paid as DECIMAL(11,2)) as interest_paid_to_date,cast(null as VARCHAR(1)) as last_payment_calculation_ind,cast(0 as DECIMAL(12,2)) as last_payment_amount,cast(0.00 as DECIMAL(11,2)) as loan_fee_override_amt,cast(0.00 as decimal(11,2)) as loan_interest_applied_to_princ,cast(0.00 as DECIMAL(11,2)) as loan_interest_in_arrears,cast(0 as DECIMAL(17,2)) as loan_payment_amount,cast(0.00 as DECIMAL(11,2)) as loan_principal_in_arrears,cast(null as INTEGER) as number_of_payments_in_arrears,cast(0 as DECIMAL(12,2)) as takeover_amount,cast(0 as DECIMAL(17,2)) as outstanding_interest_balance,cast(0 as DECIMAL(17,2)) as outstanding_principal_balance,cast(null as INTEGER) as payment_default_loan,cast(0 as DECIMAL(17,2)) as principal_paid_to_date_amt FROM super_omni_newr_loanval_daily_ng_dat;")

    ng_merged_df = merge_dataframes(
        spark=spark,
        df1=exn_xxewre01_xxewrppl_ng_df,
        df2=super_omni_newr_loanval_daily_ng_dat_df,
        primary_key=primary_key
    )

    transform_df = nw00paap_nlarc_prdps_partloan_pdab_data_dat01_df.unionByName(exn_xxewre01_xxewrppl_jb_df).unionByName(ng_merged_df)

    return transform_df